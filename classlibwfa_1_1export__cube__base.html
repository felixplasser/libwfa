<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libwfa: libwfa::export_cube_base Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libwfa<span id="projectnumber">&#160;1.1</span>
   </div>
   <div id="projectbrief">Library of wave-function analysis tools</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>libwfa</b></li><li class="navelem"><a class="el" href="classlibwfa_1_1export__cube__base.html">export_cube_base</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classlibwfa_1_1export__cube__base-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">libwfa::export_cube_base Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span><div class="ingroups"><a class="el" href="group__libwfa.html">Library of wave-function analysis tools</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Base class to export data as Gaussian cube files.  
 <a href="classlibwfa_1_1export__cube__base.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="export__cube__base_8h_source.html">export_cube_base.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for libwfa::export_cube_base:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classlibwfa_1_1export__cube__base.png" usemap="#libwfa::export_5Fcube_5Fbase_map" alt=""/>
  <map id="libwfa::export_5Fcube_5Fbase_map" name="libwfa::export_5Fcube_5Fbase_map">
<area href="classlibwfa_1_1export__cube__i.html" title="Interface class to export data as Gaussian cube files." alt="libwfa::export_cube_i" shape="rect" coords="0,0,155,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2188d89f88c24594179475165c6ac345"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibwfa_1_1export__cube__base.html#a2188d89f88c24594179475165c6ac345">export_cube_base</a> (const <a class="el" href="classlibwfa_1_1grid3d.html">grid3d</a> &amp;<a class="el" href="classlibwfa_1_1export__cube__base.html#af07b3730e305bbe70c50fc0a74e62b9a">grid</a>, const arma::uvec &amp;atnum, const arma::mat &amp;coord, const std::string &amp;prefix=&quot;&quot;, size_t batchsz=0, size_t nmax=0, const std::string &amp;comment=&quot;Generated by libwfa&quot;)</td></tr>
<tr class="memdesc:a2188d89f88c24594179475165c6ac345"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classlibwfa_1_1export__cube__base.html#a2188d89f88c24594179475165c6ac345">More...</a><br /></td></tr>
<tr class="separator:a2188d89f88c24594179475165c6ac345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ed4a628799a97f356e3baca2eb92d63"><td class="memItemLeft" align="right" valign="top"><a id="a6ed4a628799a97f356e3baca2eb92d63" name="a6ed4a628799a97f356e3baca2eb92d63"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><b>~export_cube_base</b> ()</td></tr>
<tr class="memdesc:a6ed4a628799a97f356e3baca2eb92d63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a6ed4a628799a97f356e3baca2eb92d63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af07b3730e305bbe70c50fc0a74e62b9a"><td class="memItemLeft" align="right" valign="top"><a id="af07b3730e305bbe70c50fc0a74e62b9a" name="af07b3730e305bbe70c50fc0a74e62b9a"></a>
const <a class="el" href="classlibwfa_1_1grid3d.html">grid3d</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>grid</b> () const</td></tr>
<tr class="memdesc:af07b3730e305bbe70c50fc0a74e62b9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the grid data. <br /></td></tr>
<tr class="separator:af07b3730e305bbe70c50fc0a74e62b9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18a43cce830a45495c0d0ad711b8ab2b"><td class="memItemLeft" align="right" valign="top"><a id="a18a43cce830a45495c0d0ad711b8ab2b" name="a18a43cce830a45495c0d0ad711b8ab2b"></a>
const arma::uvec &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>atomic_numbers</b> () const</td></tr>
<tr class="memdesc:a18a43cce830a45495c0d0ad711b8ab2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the vector of atomic numbers. <br /></td></tr>
<tr class="separator:a18a43cce830a45495c0d0ad711b8ab2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a474859bc08cdaad8aab678d89dcdf569"><td class="memItemLeft" align="right" valign="top"><a id="a474859bc08cdaad8aab678d89dcdf569" name="a474859bc08cdaad8aab678d89dcdf569"></a>
const arma::mat &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>atomic_coordinates</b> () const</td></tr>
<tr class="memdesc:a474859bc08cdaad8aab678d89dcdf569"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the 3xN matrix of atom positions. <br /></td></tr>
<tr class="separator:a474859bc08cdaad8aab678d89dcdf569"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e8f5d74f5003b24c4686b7f04e7d1bf"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibwfa_1_1export__cube__base.html#a7e8f5d74f5003b24c4686b7f04e7d1bf">perform</a> (const std::string &amp;name, const std::string &amp;desc, const arma::mat &amp;mat, int do_esp=0)</td></tr>
<tr class="memdesc:a7e8f5d74f5003b24c4686b7f04e7d1bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Schedule density matrix for evaluation on a grid.  <a href="classlibwfa_1_1export__cube__base.html#a7e8f5d74f5003b24c4686b7f04e7d1bf">More...</a><br /></td></tr>
<tr class="separator:a7e8f5d74f5003b24c4686b7f04e7d1bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a077e4bfc15349ef1b3fcabfe76ad40f6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibwfa_1_1export__cube__base.html#a077e4bfc15349ef1b3fcabfe76ad40f6">perform</a> (const std::string &amp;name, const std::string &amp;desc, const std::vector&lt; size_t &gt; &amp;idx, const arma::mat &amp;vecs)</td></tr>
<tr class="separator:a077e4bfc15349ef1b3fcabfe76ad40f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae02649f9d2709b949b1dcd97072aefb7"><td class="memItemLeft" align="right" valign="top"><a id="ae02649f9d2709b949b1dcd97072aefb7" name="ae02649f9d2709b949b1dcd97072aefb7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>do_export</b> ()</td></tr>
<tr class="memdesc:ae02649f9d2709b949b1dcd97072aefb7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Export the stored data as cube files. <br /></td></tr>
<tr class="separator:ae02649f9d2709b949b1dcd97072aefb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40177de88eb2b5c60c56acb15846aadd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibwfa_1_1export__cube__base.html#a40177de88eb2b5c60c56acb15846aadd">export_esp</a> (const std::string &amp;name, const std::string &amp;desc, const arma::mat &amp;dens, int do_esp)</td></tr>
<tr class="memdesc:a40177de88eb2b5c60c56acb15846aadd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the ESP.  <a href="classlibwfa_1_1export__cube__base.html#a40177de88eb2b5c60c56acb15846aadd">More...</a><br /></td></tr>
<tr class="separator:a40177de88eb2b5c60c56acb15846aadd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classlibwfa_1_1export__cube__i"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classlibwfa_1_1export__cube__i')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classlibwfa_1_1export__cube__i.html">libwfa::export_cube_i</a></td></tr>
<tr class="memitem:a61c7746bc4ac66d74680bc9da00bf1cf inherit pub_methods_classlibwfa_1_1export__cube__i"><td class="memItemLeft" align="right" valign="top"><a id="a61c7746bc4ac66d74680bc9da00bf1cf" name="a61c7746bc4ac66d74680bc9da00bf1cf"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><b>~export_cube_i</b> ()</td></tr>
<tr class="memdesc:a61c7746bc4ac66d74680bc9da00bf1cf inherit pub_methods_classlibwfa_1_1export__cube__i"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor. <br /></td></tr>
<tr class="separator:a61c7746bc4ac66d74680bc9da00bf1cf inherit pub_methods_classlibwfa_1_1export__cube__i"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-attribs" name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:ace78b2e152909b49f03a82077e5addba"><td class="memItemLeft" align="right" valign="top"><a id="ace78b2e152909b49f03a82077e5addba" name="ace78b2e152909b49f03a82077e5addba"></a>
static const char&#160;</td><td class="memItemRight" valign="bottom"><b>k_clazz</b> []</td></tr>
<tr class="memdesc:ace78b2e152909b49f03a82077e5addba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class name. <br /></td></tr>
<tr class="separator:ace78b2e152909b49f03a82077e5addba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a63eb20c4ed40efe3311055eabd1cdbf6"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibwfa_1_1export__cube__base.html#a63eb20c4ed40efe3311055eabd1cdbf6">evaluate_on_grid</a> (const arma::mat &amp;pts, size_t npts, arma::mat &amp;b2g)=0</td></tr>
<tr class="memdesc:a63eb20c4ed40efe3311055eabd1cdbf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate basis functions on a number of grid points.  <a href="classlibwfa_1_1export__cube__base.html#a63eb20c4ed40efe3311055eabd1cdbf6">More...</a><br /></td></tr>
<tr class="separator:a63eb20c4ed40efe3311055eabd1cdbf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25df926a669d43ce0c278fa0de7799dd"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibwfa_1_1export__cube__base.html#a25df926a669d43ce0c278fa0de7799dd">evaluate_esp</a> (const arma::mat &amp;pts, size_t npts, const arma::mat &amp;dens, arma::vec &amp;esp)=0</td></tr>
<tr class="memdesc:a25df926a669d43ce0c278fa0de7799dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate ESP on grid points.  <a href="classlibwfa_1_1export__cube__base.html#a25df926a669d43ce0c278fa0de7799dd">More...</a><br /></td></tr>
<tr class="separator:a25df926a669d43ce0c278fa0de7799dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aece6958c1042882cb8b01b407941a3ed"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibwfa_1_1export__cube__base.html#aece6958c1042882cb8b01b407941a3ed">nuc_esp</a> (const arma::mat &amp;pts, size_t npts, arma::vec &amp;esp)</td></tr>
<tr class="memdesc:aece6958c1042882cb8b01b407941a3ed"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate the nuclear contribution to the ESP on grid points.  <a href="classlibwfa_1_1export__cube__base.html#aece6958c1042882cb8b01b407941a3ed">More...</a><br /></td></tr>
<tr class="separator:aece6958c1042882cb8b01b407941a3ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Base class to export data as Gaussian cube files. </p>
<p >Base class to export density matrices and orbitals expressed in terms of basis functions as grid data into cube files. Any derived class has to implement the method <code>evaluate_on_grid(...)</code> (see below).</p>
<p >The class implements the export by collecting data sets and exporting them only if the number of data sets exceeds a maximum value or the function <code><a class="el" href="classlibwfa_1_1export__cube__base.html#ae02649f9d2709b949b1dcd97072aefb7" title="Export the stored data as cube files.">do_export()</a></code> is called explicitly. The latter function converts the data sets from AO basis into grid data and writes the result to disc. Two parameters govern this export behaviour:</p><ul>
<li><code>nmax</code> determines the maximum number of data sets to be stored. Zero value means that the number of stored data sets is not limited. Thus, the function <code><a class="el" href="classlibwfa_1_1export__cube__base.html#ae02649f9d2709b949b1dcd97072aefb7" title="Export the stored data as cube files.">do_export()</a></code> is never called implicitly.</li>
<li><code>batchsz</code> determines the maximum number of grid points to be exported in one go. This limits the amount of memory to be used. Zero value refers to the batch size being the total number of grid points.</li>
</ul>
<p >The grid data of the density matrices and orbitals are exported into separate files, one per density matrix or orbital. The naming scheme of the files is as follows: for density matrices the file name is constructed as </p><div class="fragment"><div class="line">prefix + name + <span class="stringliteral">&quot;.cube&quot;</span> </div>
</div><!-- fragment --><p> while for orbitals the index is appended as well </p><div class="fragment"><div class="line">prefix + name + index + <span class="stringliteral">&quot;.cube&quot;</span> </div>
</div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a2188d89f88c24594179475165c6ac345" name="a2188d89f88c24594179475165c6ac345"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2188d89f88c24594179475165c6ac345">&#9670;&nbsp;</a></span>export_cube_base()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libwfa::export_cube_base::export_cube_base </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibwfa_1_1grid3d.html">grid3d</a> &amp;&#160;</td>
          <td class="paramname"><em>grid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const arma::uvec &amp;&#160;</td>
          <td class="paramname"><em>atnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const arma::mat &amp;&#160;</td>
          <td class="paramname"><em>coord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>prefix</em> = <code>&quot;&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>batchsz</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nmax</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>comment</em> = <code>&quot;Generated&#160;by&#160;libwfa&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">grid</td><td>Grid to generate the volumetric data </td></tr>
    <tr><td class="paramname">atnum</td><td>List of atomic numbers </td></tr>
    <tr><td class="paramname">coord</td><td>List of atomic coordinates (# atoms columns x 3 rows) </td></tr>
    <tr><td class="paramname">prefix</td><td>Prefix to use for the filenames (e.g. directory) </td></tr>
    <tr><td class="paramname">batchsz</td><td>Batch size (maximum number of grid points at a time) </td></tr>
    <tr><td class="paramname">nmax</td><td>Maximum number of data sets to store (before export) </td></tr>
    <tr><td class="paramname">comment</td><td>Contents of second comment line in cube files </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a25df926a669d43ce0c278fa0de7799dd" name="a25df926a669d43ce0c278fa0de7799dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25df926a669d43ce0c278fa0de7799dd">&#9670;&nbsp;</a></span>evaluate_esp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void libwfa::export_cube_base::evaluate_esp </td>
          <td>(</td>
          <td class="paramtype">const arma::mat &amp;&#160;</td>
          <td class="paramname"><em>pts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>npts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const arma::mat &amp;&#160;</td>
          <td class="paramname"><em>dens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">arma::vec &amp;&#160;</td>
          <td class="paramname"><em>esp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate ESP on grid points. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pts</td><td>Grid points (batch size columns of length 3) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npts</td><td>Number of grid points </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dens</td><td>Density matrix </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">esp</td><td>Values of esp on grid. Convention: the electron density shall yield a negative ESP.</td></tr>
  </table>
  </dd>
</dl>
<p>Note: this requires the density matrix as opposed to evaluate_on_grid </p>

</div>
</div>
<a id="a63eb20c4ed40efe3311055eabd1cdbf6" name="a63eb20c4ed40efe3311055eabd1cdbf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63eb20c4ed40efe3311055eabd1cdbf6">&#9670;&nbsp;</a></span>evaluate_on_grid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void libwfa::export_cube_base::evaluate_on_grid </td>
          <td>(</td>
          <td class="paramtype">const arma::mat &amp;&#160;</td>
          <td class="paramname"><em>pts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>npts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">arma::mat &amp;&#160;</td>
          <td class="paramname"><em>b2g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">pure virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate basis functions on a number of grid points. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pts</td><td>Grid points (batch size columns of length 3) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npts</td><td>Number of grid points </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">b2g</td><td>Values of atomic basis functions on grid</td></tr>
  </table>
  </dd>
</dl>
<p>Implementations of the function are expected to return a matrix with NAO columns each of length NPT, where NAO is the number of atomic basis functions and NPT is the number of grid points. Each column should contain the respective basis function evaluated at the grid points provided.</p>
<p >In other words </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \chi_\mu(x_k) = B_{k\mu} \]" src="form_38.png"/>
</p>
<p> and the density can be computed as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \rho(x_k) = \sum_{\mu\nu} B_{k\mu}D_{\mu\nu}B_{k\nu} \]" src="form_39.png"/>
</p>
 
</div>
</div>
<a id="a40177de88eb2b5c60c56acb15846aadd" name="a40177de88eb2b5c60c56acb15846aadd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40177de88eb2b5c60c56acb15846aadd">&#9670;&nbsp;</a></span>export_esp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libwfa::export_cube_base::export_esp </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const arma::mat &amp;&#160;</td>
          <td class="paramname"><em>dens</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>do_esp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the ESP. </p>
<p >This requires an actual integral engine and is separate from the evaluations on a grid. </p>

</div>
</div>
<a id="aece6958c1042882cb8b01b407941a3ed" name="aece6958c1042882cb8b01b407941a3ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aece6958c1042882cb8b01b407941a3ed">&#9670;&nbsp;</a></span>nuc_esp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void libwfa::export_cube_base::nuc_esp </td>
          <td>(</td>
          <td class="paramtype">const arma::mat &amp;&#160;</td>
          <td class="paramname"><em>pts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>npts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">arma::vec &amp;&#160;</td>
          <td class="paramname"><em>esp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate the nuclear contribution to the ESP on grid points. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pts</td><td>Grid points (batch size columns of length 3) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">npts</td><td>Number of grid points </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">esp</td><td>Values of esp on grid </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a7e8f5d74f5003b24c4686b7f04e7d1bf" name="a7e8f5d74f5003b24c4686b7f04e7d1bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e8f5d74f5003b24c4686b7f04e7d1bf">&#9670;&nbsp;</a></span>perform() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void libwfa::export_cube_base::perform </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const arma::mat &amp;&#160;</td>
          <td class="paramname"><em>mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>do_esp</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Schedule density matrix for evaluation on a grid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name associated with the matrix (use as filename) </td></tr>
    <tr><td class="paramname">desc</td><td>Description of the matrix (use as comment line) </td></tr>
    <tr><td class="paramname">mat</td><td>Density matrix in terms of basis functions </td></tr>
    <tr><td class="paramname">do_esp</td><td>Switch for ESP. 0 - no ESP, 1 - only elec ESP, 2 - elec/nuc ESP </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classlibwfa_1_1export__cube__i.html#a5003bf5df2239b46a946493303fe342b">libwfa::export_cube_i</a>.</p>

</div>
</div>
<a id="a077e4bfc15349ef1b3fcabfe76ad40f6" name="a077e4bfc15349ef1b3fcabfe76ad40f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a077e4bfc15349ef1b3fcabfe76ad40f6">&#9670;&nbsp;</a></span>perform() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void libwfa::export_cube_base::perform </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; size_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const arma::mat &amp;&#160;</td>
          <td class="paramname"><em>vecs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name associated with the vectors (use as filename) </td></tr>
    <tr><td class="paramname">desc</td><td>Description of the vectors (use as comment line) </td></tr>
    <tr><td class="paramname">idx</td><td>Index list of orbitals to be exported </td></tr>
    <tr><td class="paramname">vecs</td><td>Set of vectors in basis functions (column vectors) </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classlibwfa_1_1export__cube__i.html#aa7875d4223273c0a338ab4678913cd2a">libwfa::export_cube_i</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="export__cube__base_8h_source.html">export_cube_base.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Nov 26 2021 09:31:52 for libwfa by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2
</small></address>
</body>
</html>
