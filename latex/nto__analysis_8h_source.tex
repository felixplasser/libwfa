\hypertarget{nto__analysis_8h_source}{}\doxysection{nto\+\_\+analysis.\+h}
\label{nto__analysis_8h_source}\index{nto\_analysis.h@{nto\_analysis.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef LIBWFA\_NTO\_ANALYSIS\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define LIBWFA\_NTO\_ANALYSIS\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <libwfa/core/ab\_matrix.h>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <libwfa/core/orbital\_data.h>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <libwfa/core/constants.h>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <libwfa/export/orbital\_printer\_i.h>}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{keyword}{namespace }libwfa \{}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 }
\DoxyCodeLine{18 \textcolor{keyword}{class }\mbox{\hyperlink{classlibwfa_1_1nto__analysis}{nto\_analysis}} \{}
\DoxyCodeLine{19 \textcolor{keyword}{private}:}
\DoxyCodeLine{20     \mbox{\hyperlink{classlibwfa_1_1orbital__data}{orbital\_data}} *m\_nto[4]; }
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{public}:}
\DoxyCodeLine{28     \mbox{\hyperlink{classlibwfa_1_1nto__analysis_aa9a480ef8f68fff278867083f5c5d42b}{nto\_analysis}}(\textcolor{keyword}{const} arma::mat \&s, \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&c,}
\DoxyCodeLine{29                  \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&tdm);}
\DoxyCodeLine{30 }
\DoxyCodeLine{38     \mbox{\hyperlink{classlibwfa_1_1nto__analysis_a2152bb38e949813eeaa1fd16ada6fbfe}{nto\_analysis}}(\textcolor{keyword}{const} arma::mat \&s, \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&c, \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&fock,}
\DoxyCodeLine{39                  \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&tdm, \textcolor{keywordtype}{bool} use\_fock);}
\DoxyCodeLine{40 }
\DoxyCodeLine{48     \mbox{\hyperlink{classlibwfa_1_1nto__analysis_a8759aa759f4a1b12f9dceb305243cec1}{nto\_analysis}}(\textcolor{keyword}{const} arma::mat \&s, \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&c,}
\DoxyCodeLine{49                  \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&edm, \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&hdm) \{}
\DoxyCodeLine{50 }
\DoxyCodeLine{51       initialize(s, c, edm, hdm);}
\DoxyCodeLine{52     \}}
\DoxyCodeLine{53 }
\DoxyCodeLine{54 }
\DoxyCodeLine{55     \mbox{\hyperlink{classlibwfa_1_1nto__analysis_aa9a480ef8f68fff278867083f5c5d42b}{nto\_analysis}}(\textcolor{keyword}{const} arma::mat \&s, \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&c,}
\DoxyCodeLine{56                            \textcolor{keyword}{const} \mbox{\hyperlink{structh__so}{h\_so}}\& h\_so1e, \textcolor{keyword}{const} \mbox{\hyperlink{structh__so}{h\_so}}\& h\_somf,}
\DoxyCodeLine{57                            \textcolor{keyword}{const} arma::mat \&tdm);}
\DoxyCodeLine{58 }
\DoxyCodeLine{61     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classlibwfa_1_1nto__analysis_aab28982d4d5faa763d72d5e935d1b787}{is\_alpha\_eq\_beta}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_nto[2] == 0; \}}
\DoxyCodeLine{62 }
\DoxyCodeLine{69     \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1orbital__data}{orbital\_data}} \&\mbox{\hyperlink{classlibwfa_1_1nto__analysis_aa59847d4b78448bd3c40a726991eb80f}{get\_ntos}}(\textcolor{keywordtype}{bool} el, \textcolor{keywordtype}{bool} spin)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{70         \textcolor{keywordflow}{return} *m\_nto[(el ? 0 : 1) + (spin \&\& m\_nto[2] ? 2 : 0)];}
\DoxyCodeLine{71     \}}
\DoxyCodeLine{72 }
\DoxyCodeLine{77     \textcolor{keywordtype}{void} \mbox{\hyperlink{classlibwfa_1_1nto__analysis_a3967333f89695035b036d49f1cd3d19e}{analyse}}(std::ostream \&out, \textcolor{keywordtype}{size\_t} nnto = 3) \textcolor{keyword}{const};}
\DoxyCodeLine{78 }
\DoxyCodeLine{84     \textcolor{keywordtype}{void} \mbox{\hyperlink{classlibwfa_1_1nto__analysis_aaef2c6a8a869d8b1531ff88d43f4c544}{export\_orbitals}}(\mbox{\hyperlink{classlibwfa_1_1orbital__printer__i}{orbital\_printer\_i}} \&pr, \textcolor{keywordtype}{double} thresh = 1e-\/6) \textcolor{keyword}{const};}
\DoxyCodeLine{85 }
\DoxyCodeLine{103     \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{classlibwfa_1_1nto__analysis_a980d87599408017b85ca4db4582bd3a3}{form\_eh}}(\textcolor{keyword}{const} arma::mat \&s, \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&tdm,}
\DoxyCodeLine{104         \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&edm, \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&hdm);}
\DoxyCodeLine{105 }
\DoxyCodeLine{106 \textcolor{keyword}{private}:}
\DoxyCodeLine{107     \textcolor{keywordtype}{void} initialize(\textcolor{keyword}{const} arma::mat \&s, \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&c,}
\DoxyCodeLine{108         \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&edm, \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&hdm);}
\DoxyCodeLine{109 }
\DoxyCodeLine{110     \textcolor{keywordtype}{void} initialize\_proper(\textcolor{keyword}{const} arma::mat \&s, \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&c,}
\DoxyCodeLine{111                            \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&tdm);}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     \textcolor{keywordtype}{void} initialize\_proper(\textcolor{keyword}{const} arma::mat \&s, \textcolor{keyword}{const} \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\_matrix}} \&c,}
\DoxyCodeLine{114                            \textcolor{keyword}{const} arma::mat \&tdm);}
\DoxyCodeLine{115 }
\DoxyCodeLine{116     \textcolor{keyword}{static} \textcolor{keywordtype}{void} analysis(std::ostream \&out,}
\DoxyCodeLine{117                          \textcolor{keyword}{const} arma::vec \&e, \textcolor{keywordtype}{size\_t} nnto = 3);}
\DoxyCodeLine{118 }
\DoxyCodeLine{119     \textcolor{keyword}{static} \textcolor{keywordtype}{void} nto\_stats(std::ostream \&out, \textcolor{keyword}{const} arma::vec \&e);}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     \textcolor{keyword}{static} \textcolor{keywordtype}{void} analysis(std::ostream \&out,}
\DoxyCodeLine{122                          \textcolor{keyword}{const} arma::vec \&e,}
\DoxyCodeLine{123                          \textcolor{keyword}{const} arma::vec \&hole\_e,}
\DoxyCodeLine{124                          \textcolor{keyword}{const} arma::vec \&e\_e,}
\DoxyCodeLine{125                          \textcolor{keywordtype}{size\_t} nnto = 3);}
\DoxyCodeLine{126 }
\DoxyCodeLine{127     \textcolor{keyword}{static} \textcolor{keywordtype}{void} analysis(std::ostream \&out,}
\DoxyCodeLine{128         std::vector<soc>\& vec\_so1e, std::vector<soc>\& vec\_somf,}
\DoxyCodeLine{129         \textcolor{keyword}{const} arma::vec \&e, \textcolor{keywordtype}{size\_t} nnto = 3);}
\DoxyCodeLine{130 }
\DoxyCodeLine{131     \textcolor{keyword}{static} \textcolor{keywordtype}{void} build\_selector(\textcolor{keyword}{const} arma::vec \&e, \textcolor{keyword}{const} arma::vec \&h,}
\DoxyCodeLine{132         \textcolor{keywordtype}{double} thresh, \mbox{\hyperlink{classlibwfa_1_1orbital__selector}{orbital\_selector}} \&sel);}
\DoxyCodeLine{133 }
\DoxyCodeLine{134     \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{classlibwfa_1_1nto__analysis_a980d87599408017b85ca4db4582bd3a3}{form\_eh}}(\textcolor{keyword}{const} arma::mat \&s, \textcolor{keyword}{const} arma::mat \&tdm,}
\DoxyCodeLine{135         arma::mat \&edm, arma::mat \&hdm) \{}
\DoxyCodeLine{136 }
\DoxyCodeLine{137         edm = tdm.t() * s * tdm;}
\DoxyCodeLine{138         hdm = tdm * s * tdm.t();}
\DoxyCodeLine{139     \}}
\DoxyCodeLine{140 \};}
\DoxyCodeLine{141 }
\DoxyCodeLine{142 }
\DoxyCodeLine{143 \} \textcolor{comment}{// namespace libwfa}}
\DoxyCodeLine{144 }
\DoxyCodeLine{145 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
