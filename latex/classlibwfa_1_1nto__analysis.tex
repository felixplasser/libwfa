\hypertarget{classlibwfa_1_1nto__analysis}{}\doxysection{libwfa\+::nto\+\_\+analysis Class Reference}
\label{classlibwfa_1_1nto__analysis}\index{libwfa::nto\_analysis@{libwfa::nto\_analysis}}


Perform complete NTO analysis of a transition density matrix.  




{\ttfamily \#include $<$nto\+\_\+analysis.\+h$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classlibwfa_1_1nto__analysis_aa9a480ef8f68fff278867083f5c5d42b}{nto\+\_\+analysis}} (const arma\+::mat \&s, const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&c, const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&tdm)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classlibwfa_1_1nto__analysis_a2152bb38e949813eeaa1fd16ada6fbfe}{nto\+\_\+analysis}} (const arma\+::mat \&s, const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&c, const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&fock, const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&tdm, bool use\+\_\+fock)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classlibwfa_1_1nto__analysis_a8759aa759f4a1b12f9dceb305243cec1}{nto\+\_\+analysis}} (const arma\+::mat \&s, const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&c, const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&edm, const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&hdm)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classlibwfa_1_1nto__analysis_ae6c93e59e027a132a3c17430ad916d77}\label{classlibwfa_1_1nto__analysis_ae6c93e59e027a132a3c17430ad916d77}} 
{\bfseries nto\+\_\+analysis} (const arma\+::mat \&s, const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&c, const \mbox{\hyperlink{structh__so}{h\+\_\+so}} \&h\+\_\+so1e, const \mbox{\hyperlink{structh__so}{h\+\_\+so}} \&h\+\_\+somf, const arma\+::mat \&tdm)
\item 
\mbox{\Hypertarget{classlibwfa_1_1nto__analysis_aab28982d4d5faa763d72d5e935d1b787}\label{classlibwfa_1_1nto__analysis_aab28982d4d5faa763d72d5e935d1b787}} 
bool {\bfseries is\+\_\+alpha\+\_\+eq\+\_\+beta} () const
\begin{DoxyCompactList}\small\item\em Is alpha == beta. \end{DoxyCompactList}\item 
const \mbox{\hyperlink{classlibwfa_1_1orbital__data}{orbital\+\_\+data}} \& \mbox{\hyperlink{classlibwfa_1_1nto__analysis_aa59847d4b78448bd3c40a726991eb80f}{get\+\_\+ntos}} (bool el, bool spin) const
\begin{DoxyCompactList}\small\item\em Retrieve NTOs. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classlibwfa_1_1nto__analysis_a3967333f89695035b036d49f1cd3d19e}{analyse}} (std\+::ostream \&out, size\+\_\+t nnto=3) const
\begin{DoxyCompactList}\small\item\em Perform NTO analysis. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classlibwfa_1_1nto__analysis_aaef2c6a8a869d8b1531ff88d43f4c544}{export\+\_\+orbitals}} (\mbox{\hyperlink{classlibwfa_1_1orbital__printer__i}{orbital\+\_\+printer\+\_\+i}} \&pr, double thresh=1e-\/6) const
\begin{DoxyCompactList}\small\item\em Export NTOs. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{classlibwfa_1_1nto__analysis_a980d87599408017b85ca4db4582bd3a3}{form\+\_\+eh}} (const arma\+::mat \&s, const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&tdm, \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&edm, \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&hdm)
\begin{DoxyCompactList}\small\item\em Construct the electron and hole density matrices. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Perform complete NTO analysis of a transition density matrix. 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlibwfa_1_1nto__analysis_aa9a480ef8f68fff278867083f5c5d42b}\label{classlibwfa_1_1nto__analysis_aa9a480ef8f68fff278867083f5c5d42b}} 
\index{libwfa::nto\_analysis@{libwfa::nto\_analysis}!nto\_analysis@{nto\_analysis}}
\index{nto\_analysis@{nto\_analysis}!libwfa::nto\_analysis@{libwfa::nto\_analysis}}
\doxysubsubsection{\texorpdfstring{nto\_analysis()}{nto\_analysis()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily libwfa\+::nto\+\_\+analysis\+::nto\+\_\+analysis (\begin{DoxyParamCaption}\item[{const arma\+::mat \&}]{s,  }\item[{const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&}]{c,  }\item[{const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&}]{tdm }\end{DoxyParamCaption})}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em s} & Overlap matrix \\
\hline
{\em c} & Orbital coefficient matrix for transform in orthogonal basis \\
\hline
{\em tdm} & Transition density matrix \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classlibwfa_1_1nto__analysis_a2152bb38e949813eeaa1fd16ada6fbfe}\label{classlibwfa_1_1nto__analysis_a2152bb38e949813eeaa1fd16ada6fbfe}} 
\index{libwfa::nto\_analysis@{libwfa::nto\_analysis}!nto\_analysis@{nto\_analysis}}
\index{nto\_analysis@{nto\_analysis}!libwfa::nto\_analysis@{libwfa::nto\_analysis}}
\doxysubsubsection{\texorpdfstring{nto\_analysis()}{nto\_analysis()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily libwfa\+::nto\+\_\+analysis\+::nto\+\_\+analysis (\begin{DoxyParamCaption}\item[{const arma\+::mat \&}]{s,  }\item[{const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&}]{c,  }\item[{const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&}]{fock,  }\item[{const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&}]{tdm,  }\item[{bool}]{use\+\_\+fock }\end{DoxyParamCaption})}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em s} & Overlap matrix \\
\hline
{\em c} & Orbital coefficient matrix for transform in orthogonal basis \\
\hline
{\em fock} & Fock matrix in AOs \\
\hline
{\em tdm} & Transition density matrix \\
\hline
{\em use\+\_\+fock} & to turn on/off energies \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classlibwfa_1_1nto__analysis_a8759aa759f4a1b12f9dceb305243cec1}\label{classlibwfa_1_1nto__analysis_a8759aa759f4a1b12f9dceb305243cec1}} 
\index{libwfa::nto\_analysis@{libwfa::nto\_analysis}!nto\_analysis@{nto\_analysis}}
\index{nto\_analysis@{nto\_analysis}!libwfa::nto\_analysis@{libwfa::nto\_analysis}}
\doxysubsubsection{\texorpdfstring{nto\_analysis()}{nto\_analysis()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily libwfa\+::nto\+\_\+analysis\+::nto\+\_\+analysis (\begin{DoxyParamCaption}\item[{const arma\+::mat \&}]{s,  }\item[{const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&}]{c,  }\item[{const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&}]{edm,  }\item[{const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&}]{hdm }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em s} & Overlap matrix \\
\hline
{\em c} & Orbital coefficient matrix for transform in orthogonal basis \\
\hline
{\em edm} & Electron density matrix \\
\hline
{\em hdm} & Hole density matrix \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classlibwfa_1_1nto__analysis_a3967333f89695035b036d49f1cd3d19e}\label{classlibwfa_1_1nto__analysis_a3967333f89695035b036d49f1cd3d19e}} 
\index{libwfa::nto\_analysis@{libwfa::nto\_analysis}!analyse@{analyse}}
\index{analyse@{analyse}!libwfa::nto\_analysis@{libwfa::nto\_analysis}}
\doxysubsubsection{\texorpdfstring{analyse()}{analyse()}}
{\footnotesize\ttfamily void libwfa\+::nto\+\_\+analysis\+::analyse (\begin{DoxyParamCaption}\item[{std\+::ostream \&}]{out,  }\item[{size\+\_\+t}]{nnto = {\ttfamily 3} }\end{DoxyParamCaption}) const}



Perform NTO analysis. 


\begin{DoxyParams}{Parameters}
{\em out} & Output stream \\
\hline
{\em nnto} & Number of leading NTOs \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classlibwfa_1_1nto__analysis_aaef2c6a8a869d8b1531ff88d43f4c544}\label{classlibwfa_1_1nto__analysis_aaef2c6a8a869d8b1531ff88d43f4c544}} 
\index{libwfa::nto\_analysis@{libwfa::nto\_analysis}!export\_orbitals@{export\_orbitals}}
\index{export\_orbitals@{export\_orbitals}!libwfa::nto\_analysis@{libwfa::nto\_analysis}}
\doxysubsubsection{\texorpdfstring{export\_orbitals()}{export\_orbitals()}}
{\footnotesize\ttfamily void libwfa\+::nto\+\_\+analysis\+::export\+\_\+orbitals (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classlibwfa_1_1orbital__printer__i}{orbital\+\_\+printer\+\_\+i}} \&}]{pr,  }\item[{double}]{thresh = {\ttfamily 1e-\/6} }\end{DoxyParamCaption}) const}



Export NTOs. 


\begin{DoxyParams}{Parameters}
{\em pr} & Orbital printer \\
\hline
{\em thresh} & Zero threshold (default\+: $ 10^-6 $) \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classlibwfa_1_1nto__analysis_a980d87599408017b85ca4db4582bd3a3}\label{classlibwfa_1_1nto__analysis_a980d87599408017b85ca4db4582bd3a3}} 
\index{libwfa::nto\_analysis@{libwfa::nto\_analysis}!form\_eh@{form\_eh}}
\index{form\_eh@{form\_eh}!libwfa::nto\_analysis@{libwfa::nto\_analysis}}
\doxysubsubsection{\texorpdfstring{form\_eh()}{form\_eh()}}
{\footnotesize\ttfamily static void libwfa\+::nto\+\_\+analysis\+::form\+\_\+eh (\begin{DoxyParamCaption}\item[{const arma\+::mat \&}]{s,  }\item[{const \mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&}]{tdm,  }\item[{\mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&}]{edm,  }\item[{\mbox{\hyperlink{classlibwfa_1_1ab__matrix}{ab\+\_\+matrix}} \&}]{hdm }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Construct the electron and hole density matrices. 


\begin{DoxyParams}{Parameters}
{\em s} & Overlap matrix \\
\hline
{\em tdm} & Transition density matrix \\
\hline
{\em edm} & Electron density matrix \\
\hline
{\em hdm} & Hole density matrix\\
\hline
\end{DoxyParams}
The function implements the transforms of the transition density matrix into electron and hole density matrices \[ E_{\mu\nu} = \sum_{\eta\xi} T_{\mu\eta} S_{\eta\xi} T_{\nu\xi} \] and \[ H_{\mu\nu} = \sum_{\eta\xi} T_{\eta\mu} S_{\eta\xi} T_{\xi\nu} \] The output matrices are reshaped and resized as required. \mbox{\Hypertarget{classlibwfa_1_1nto__analysis_aa59847d4b78448bd3c40a726991eb80f}\label{classlibwfa_1_1nto__analysis_aa59847d4b78448bd3c40a726991eb80f}} 
\index{libwfa::nto\_analysis@{libwfa::nto\_analysis}!get\_ntos@{get\_ntos}}
\index{get\_ntos@{get\_ntos}!libwfa::nto\_analysis@{libwfa::nto\_analysis}}
\doxysubsubsection{\texorpdfstring{get\_ntos()}{get\_ntos()}}
{\footnotesize\ttfamily const \mbox{\hyperlink{classlibwfa_1_1orbital__data}{orbital\+\_\+data}} \& libwfa\+::nto\+\_\+analysis\+::get\+\_\+ntos (\begin{DoxyParamCaption}\item[{bool}]{el,  }\item[{bool}]{spin }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



Retrieve NTOs. 


\begin{DoxyParams}{Parameters}
{\em el} & True\+: electron NTOs; false\+: hole NTOs \\
\hline
{\em spin} & True\+: beta NTOs; false\+: alpha NTOs\\
\hline
\end{DoxyParams}
TODO\+: Is spin definition best this way? 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
nto\+\_\+analysis.\+h\end{DoxyCompactItemize}
