\hypertarget{classlibwfa_1_1export__cube__base}{}\doxysection{libwfa\+::export\+\_\+cube\+\_\+base Class Reference}
\label{classlibwfa_1_1export__cube__base}\index{libwfa::export\_cube\_base@{libwfa::export\_cube\_base}}


Base class to export data as Gaussian cube files.  




{\ttfamily \#include $<$export\+\_\+cube\+\_\+base.\+h$>$}

Inheritance diagram for libwfa\+::export\+\_\+cube\+\_\+base\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classlibwfa_1_1export__cube__base}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classlibwfa_1_1export__cube__base_a2188d89f88c24594179475165c6ac345}{export\+\_\+cube\+\_\+base}} (const \mbox{\hyperlink{classlibwfa_1_1grid3d}{grid3d}} \&\mbox{\hyperlink{classlibwfa_1_1export__cube__base_af07b3730e305bbe70c50fc0a74e62b9a}{grid}}, const arma\+::uvec \&atnum, const arma\+::mat \&coord, const std\+::string \&prefix=\char`\"{}\char`\"{}, size\+\_\+t batchsz=0, size\+\_\+t nmax=0, const std\+::string \&comment=\char`\"{}Generated by libwfa\char`\"{})
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classlibwfa_1_1export__cube__base_a6ed4a628799a97f356e3baca2eb92d63}\label{classlibwfa_1_1export__cube__base_a6ed4a628799a97f356e3baca2eb92d63}} 
virtual {\bfseries $\sim$export\+\_\+cube\+\_\+base} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classlibwfa_1_1export__cube__base_af07b3730e305bbe70c50fc0a74e62b9a}\label{classlibwfa_1_1export__cube__base_af07b3730e305bbe70c50fc0a74e62b9a}} 
const \mbox{\hyperlink{classlibwfa_1_1grid3d}{grid3d}} \& {\bfseries grid} () const
\begin{DoxyCompactList}\small\item\em Return the grid data. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classlibwfa_1_1export__cube__base_a18a43cce830a45495c0d0ad711b8ab2b}\label{classlibwfa_1_1export__cube__base_a18a43cce830a45495c0d0ad711b8ab2b}} 
const arma\+::uvec \& {\bfseries atomic\+\_\+numbers} () const
\begin{DoxyCompactList}\small\item\em Return the vector of atomic numbers. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classlibwfa_1_1export__cube__base_a474859bc08cdaad8aab678d89dcdf569}\label{classlibwfa_1_1export__cube__base_a474859bc08cdaad8aab678d89dcdf569}} 
const arma\+::mat \& {\bfseries atomic\+\_\+coordinates} () const
\begin{DoxyCompactList}\small\item\em Return the 3xN matrix of atom positions. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classlibwfa_1_1export__cube__base_a7e8f5d74f5003b24c4686b7f04e7d1bf}{perform}} (const std\+::string \&name, const std\+::string \&desc, const arma\+::mat \&mat, int do\+\_\+esp=0)
\begin{DoxyCompactList}\small\item\em Schedule density matrix for evaluation on a grid. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classlibwfa_1_1export__cube__base_a077e4bfc15349ef1b3fcabfe76ad40f6}{perform}} (const std\+::string \&name, const std\+::string \&desc, const std\+::vector$<$ size\+\_\+t $>$ \&idx, const arma\+::mat \&vecs)
\item 
\mbox{\Hypertarget{classlibwfa_1_1export__cube__base_ae02649f9d2709b949b1dcd97072aefb7}\label{classlibwfa_1_1export__cube__base_ae02649f9d2709b949b1dcd97072aefb7}} 
void {\bfseries do\+\_\+export} ()
\begin{DoxyCompactList}\small\item\em Export the stored data as cube files. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classlibwfa_1_1export__cube__base_a40177de88eb2b5c60c56acb15846aadd}{export\+\_\+esp}} (const std\+::string \&name, const std\+::string \&desc, const arma\+::mat \&dens, int do\+\_\+esp)
\begin{DoxyCompactList}\small\item\em Compute the ESP. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classlibwfa_1_1export__cube__base_ace78b2e152909b49f03a82077e5addba}\label{classlibwfa_1_1export__cube__base_ace78b2e152909b49f03a82077e5addba}} 
static const char {\bfseries k\+\_\+clazz} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em Class name. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \mbox{\hyperlink{classlibwfa_1_1export__cube__base_a63eb20c4ed40efe3311055eabd1cdbf6}{evaluate\+\_\+on\+\_\+grid}} (const arma\+::mat \&pts, size\+\_\+t npts, arma\+::mat \&b2g)=0
\begin{DoxyCompactList}\small\item\em Evaluate basis functions on a number of grid points. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classlibwfa_1_1export__cube__base_a25df926a669d43ce0c278fa0de7799dd}{evaluate\+\_\+esp}} (const arma\+::mat \&pts, size\+\_\+t npts, const arma\+::mat \&dens, arma\+::vec \&esp)=0
\begin{DoxyCompactList}\small\item\em Evaluate ESP on grid points. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classlibwfa_1_1export__cube__base_aece6958c1042882cb8b01b407941a3ed}{nuc\+\_\+esp}} (const arma\+::mat \&pts, size\+\_\+t npts, arma\+::vec \&esp)
\begin{DoxyCompactList}\small\item\em Evaluate the nuclear contribution to the ESP on grid points. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Base class to export data as Gaussian cube files. 

Base class to export density matrices and orbitals expressed in terms of basis functions as grid data into cube files. Any derived class has to implement the method {\ttfamily evaluate\+\_\+on\+\_\+grid(...)} (see below).

The class implements the export by collecting data sets and exporting them only if the number of data sets exceeds a maximum value or the function {\ttfamily \mbox{\hyperlink{classlibwfa_1_1export__cube__base_ae02649f9d2709b949b1dcd97072aefb7}{do\+\_\+export()}}} is called explicitly. The latter function converts the data sets from AO basis into grid data and writes the result to disc. Two parameters govern this export behaviour\+:
\begin{DoxyItemize}
\item {\ttfamily nmax} determines the maximum number of data sets to be stored. Zero value means that the number of stored data sets is not limited. Thus, the function {\ttfamily \mbox{\hyperlink{classlibwfa_1_1export__cube__base_ae02649f9d2709b949b1dcd97072aefb7}{do\+\_\+export()}}} is never called implicitly.
\item {\ttfamily batchsz} determines the maximum number of grid points to be exported in one go. This limits the amount of memory to be used. Zero value refers to the batch size being the total number of grid points.
\end{DoxyItemize}

The grid data of the density matrices and orbitals are exported into separate files, one per density matrix or orbital. The naming scheme of the files is as follows\+: for density matrices the file name is constructed as 
\begin{DoxyCode}{0}
\DoxyCodeLine{prefix + name + \textcolor{stringliteral}{"{}.cube"{}} }

\end{DoxyCode}
 while for orbitals the index is appended as well 
\begin{DoxyCode}{0}
\DoxyCodeLine{prefix + name + index + \textcolor{stringliteral}{"{}.cube"{}} }

\end{DoxyCode}
 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlibwfa_1_1export__cube__base_a2188d89f88c24594179475165c6ac345}\label{classlibwfa_1_1export__cube__base_a2188d89f88c24594179475165c6ac345}} 
\index{libwfa::export\_cube\_base@{libwfa::export\_cube\_base}!export\_cube\_base@{export\_cube\_base}}
\index{export\_cube\_base@{export\_cube\_base}!libwfa::export\_cube\_base@{libwfa::export\_cube\_base}}
\doxysubsubsection{\texorpdfstring{export\_cube\_base()}{export\_cube\_base()}}
{\footnotesize\ttfamily libwfa\+::export\+\_\+cube\+\_\+base\+::export\+\_\+cube\+\_\+base (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classlibwfa_1_1grid3d}{grid3d}} \&}]{grid,  }\item[{const arma\+::uvec \&}]{atnum,  }\item[{const arma\+::mat \&}]{coord,  }\item[{const std\+::string \&}]{prefix = {\ttfamily \char`\"{}\char`\"{}},  }\item[{size\+\_\+t}]{batchsz = {\ttfamily 0},  }\item[{size\+\_\+t}]{nmax = {\ttfamily 0},  }\item[{const std\+::string \&}]{comment = {\ttfamily \char`\"{}Generated~by~libwfa\char`\"{}} }\end{DoxyParamCaption})}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em grid} & Grid to generate the volumetric data \\
\hline
{\em atnum} & List of atomic numbers \\
\hline
{\em coord} & List of atomic coordinates (\# atoms columns x 3 rows) \\
\hline
{\em prefix} & Prefix to use for the filenames (e.\+g. directory) \\
\hline
{\em batchsz} & Batch size (maximum number of grid points at a time) \\
\hline
{\em nmax} & Maximum number of data sets to store (before export) \\
\hline
{\em comment} & Contents of second comment line in cube files \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classlibwfa_1_1export__cube__base_a25df926a669d43ce0c278fa0de7799dd}\label{classlibwfa_1_1export__cube__base_a25df926a669d43ce0c278fa0de7799dd}} 
\index{libwfa::export\_cube\_base@{libwfa::export\_cube\_base}!evaluate\_esp@{evaluate\_esp}}
\index{evaluate\_esp@{evaluate\_esp}!libwfa::export\_cube\_base@{libwfa::export\_cube\_base}}
\doxysubsubsection{\texorpdfstring{evaluate\_esp()}{evaluate\_esp()}}
{\footnotesize\ttfamily virtual void libwfa\+::export\+\_\+cube\+\_\+base\+::evaluate\+\_\+esp (\begin{DoxyParamCaption}\item[{const arma\+::mat \&}]{pts,  }\item[{size\+\_\+t}]{npts,  }\item[{const arma\+::mat \&}]{dens,  }\item[{arma\+::vec \&}]{esp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [pure virtual]}}



Evaluate ESP on grid points. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em pts} & Grid points (batch size columns of length 3) \\
\hline
\mbox{\texttt{ in}}  & {\em npts} & Number of grid points \\
\hline
\mbox{\texttt{ in}}  & {\em dens} & Density matrix \\
\hline
\mbox{\texttt{ out}}  & {\em esp} & Values of esp on grid. Convention\+: the electron density shall yield a negative ESP.\\
\hline
\end{DoxyParams}
Note\+: this requires the density matrix as opposed to evaluate\+\_\+on\+\_\+grid \mbox{\Hypertarget{classlibwfa_1_1export__cube__base_a63eb20c4ed40efe3311055eabd1cdbf6}\label{classlibwfa_1_1export__cube__base_a63eb20c4ed40efe3311055eabd1cdbf6}} 
\index{libwfa::export\_cube\_base@{libwfa::export\_cube\_base}!evaluate\_on\_grid@{evaluate\_on\_grid}}
\index{evaluate\_on\_grid@{evaluate\_on\_grid}!libwfa::export\_cube\_base@{libwfa::export\_cube\_base}}
\doxysubsubsection{\texorpdfstring{evaluate\_on\_grid()}{evaluate\_on\_grid()}}
{\footnotesize\ttfamily virtual void libwfa\+::export\+\_\+cube\+\_\+base\+::evaluate\+\_\+on\+\_\+grid (\begin{DoxyParamCaption}\item[{const arma\+::mat \&}]{pts,  }\item[{size\+\_\+t}]{npts,  }\item[{arma\+::mat \&}]{b2g }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [pure virtual]}}



Evaluate basis functions on a number of grid points. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em pts} & Grid points (batch size columns of length 3) \\
\hline
\mbox{\texttt{ in}}  & {\em npts} & Number of grid points \\
\hline
\mbox{\texttt{ out}}  & {\em b2g} & Values of atomic basis functions on grid\\
\hline
\end{DoxyParams}
Implementations of the function are expected to return a matrix with NAO columns each of length NPT, where NAO is the number of atomic basis functions and NPT is the number of grid points. Each column should contain the respective basis function evaluated at the grid points provided.

In other words \[ \chi_\mu(x_k) = B_{k\mu} \] and the density can be computed as \[ \rho(x_k) = \sum_{\mu\nu} B_{k\mu}D_{\mu\nu}B_{k\nu} \] \mbox{\Hypertarget{classlibwfa_1_1export__cube__base_a40177de88eb2b5c60c56acb15846aadd}\label{classlibwfa_1_1export__cube__base_a40177de88eb2b5c60c56acb15846aadd}} 
\index{libwfa::export\_cube\_base@{libwfa::export\_cube\_base}!export\_esp@{export\_esp}}
\index{export\_esp@{export\_esp}!libwfa::export\_cube\_base@{libwfa::export\_cube\_base}}
\doxysubsubsection{\texorpdfstring{export\_esp()}{export\_esp()}}
{\footnotesize\ttfamily void libwfa\+::export\+\_\+cube\+\_\+base\+::export\+\_\+esp (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{name,  }\item[{const std\+::string \&}]{desc,  }\item[{const arma\+::mat \&}]{dens,  }\item[{int}]{do\+\_\+esp }\end{DoxyParamCaption})}



Compute the ESP. 

This requires an actual integral engine and is separate from the evaluations on a grid. \mbox{\Hypertarget{classlibwfa_1_1export__cube__base_aece6958c1042882cb8b01b407941a3ed}\label{classlibwfa_1_1export__cube__base_aece6958c1042882cb8b01b407941a3ed}} 
\index{libwfa::export\_cube\_base@{libwfa::export\_cube\_base}!nuc\_esp@{nuc\_esp}}
\index{nuc\_esp@{nuc\_esp}!libwfa::export\_cube\_base@{libwfa::export\_cube\_base}}
\doxysubsubsection{\texorpdfstring{nuc\_esp()}{nuc\_esp()}}
{\footnotesize\ttfamily virtual void libwfa\+::export\+\_\+cube\+\_\+base\+::nuc\+\_\+esp (\begin{DoxyParamCaption}\item[{const arma\+::mat \&}]{pts,  }\item[{size\+\_\+t}]{npts,  }\item[{arma\+::vec \&}]{esp }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}



Evaluate the nuclear contribution to the ESP on grid points. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em pts} & Grid points (batch size columns of length 3) \\
\hline
\mbox{\texttt{ in}}  & {\em npts} & Number of grid points \\
\hline
\mbox{\texttt{ out}}  & {\em esp} & Values of esp on grid \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classlibwfa_1_1export__cube__base_a7e8f5d74f5003b24c4686b7f04e7d1bf}\label{classlibwfa_1_1export__cube__base_a7e8f5d74f5003b24c4686b7f04e7d1bf}} 
\index{libwfa::export\_cube\_base@{libwfa::export\_cube\_base}!perform@{perform}}
\index{perform@{perform}!libwfa::export\_cube\_base@{libwfa::export\_cube\_base}}
\doxysubsubsection{\texorpdfstring{perform()}{perform()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily virtual void libwfa\+::export\+\_\+cube\+\_\+base\+::perform (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{name,  }\item[{const std\+::string \&}]{desc,  }\item[{const arma\+::mat \&}]{mat,  }\item[{int}]{do\+\_\+esp = {\ttfamily 0} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Schedule density matrix for evaluation on a grid. 


\begin{DoxyParams}{Parameters}
{\em name} & Name associated with the matrix (use as filename) \\
\hline
{\em desc} & Description of the matrix (use as comment line) \\
\hline
{\em mat} & Density matrix in terms of basis functions \\
\hline
{\em do\+\_\+esp} & Switch for ESP. 0 -\/ no ESP, 1 -\/ only elec ESP, 2 -\/ elec/nuc ESP \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classlibwfa_1_1export__cube__i_a5003bf5df2239b46a946493303fe342b}{libwfa\+::export\+\_\+cube\+\_\+i}}.

\mbox{\Hypertarget{classlibwfa_1_1export__cube__base_a077e4bfc15349ef1b3fcabfe76ad40f6}\label{classlibwfa_1_1export__cube__base_a077e4bfc15349ef1b3fcabfe76ad40f6}} 
\index{libwfa::export\_cube\_base@{libwfa::export\_cube\_base}!perform@{perform}}
\index{perform@{perform}!libwfa::export\_cube\_base@{libwfa::export\_cube\_base}}
\doxysubsubsection{\texorpdfstring{perform()}{perform()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily virtual void libwfa\+::export\+\_\+cube\+\_\+base\+::perform (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{name,  }\item[{const std\+::string \&}]{desc,  }\item[{const std\+::vector$<$ size\+\_\+t $>$ \&}]{idx,  }\item[{const arma\+::mat \&}]{vecs }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}






\begin{DoxyParams}{Parameters}
{\em name} & Name associated with the vectors (use as filename) \\
\hline
{\em desc} & Description of the vectors (use as comment line) \\
\hline
{\em idx} & Index list of orbitals to be exported \\
\hline
{\em vecs} & Set of vectors in basis functions (column vectors) \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classlibwfa_1_1export__cube__i_aa7875d4223273c0a338ab4678913cd2a}{libwfa\+::export\+\_\+cube\+\_\+i}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
export\+\_\+cube\+\_\+base.\+h\end{DoxyCompactItemize}
