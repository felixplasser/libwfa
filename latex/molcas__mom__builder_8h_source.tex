\hypertarget{molcas__mom__builder_8h_source}{}\doxysection{molcas\+\_\+mom\+\_\+builder.\+h}
\label{molcas__mom__builder_8h_source}\index{molcas\_mom\_builder.h@{molcas\_mom\_builder.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef LIBWFA\_MOLCAS\_MOM\_BUILDER\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define LIBWFA\_MOLCAS\_MOM\_BUILDER\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}H5Cpp.h"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <libwfa/core/mom\_builder\_i.h>}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{keyword}{namespace }libwfa \{}
\DoxyCodeLine{8 }
\DoxyCodeLine{15 \textcolor{keyword}{class }\mbox{\hyperlink{classlibwfa_1_1molcas__mom__builder}{molcas\_mom\_builder}} : \textcolor{keyword}{public} \mbox{\hyperlink{classlibwfa_1_1mom__builder__i}{libwfa::mom\_builder\_i}} \{}
\DoxyCodeLine{16 \textcolor{keyword}{private}:}
\DoxyCodeLine{17     \textcolor{keyword}{mutable} std::vector<arma::mat *> m\_op;}
\DoxyCodeLine{18     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} m\_maxmm;}
\DoxyCodeLine{19     \textcolor{keywordtype}{size\_t} m\_nao;}
\DoxyCodeLine{20     \textcolor{comment}{/*H5::File m\_file; //!< HDF5 file with data}}
\DoxyCodeLine{21 \textcolor{comment}{    const arma::mat  m\_desym; //!< Desymmetrization matrix*/}}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{keyword}{public}:}
\DoxyCodeLine{26     \mbox{\hyperlink{classlibwfa_1_1molcas__mom__builder_a7fe311c284b963a336972ff5c1f81710}{molcas\_mom\_builder}}(\textcolor{keywordtype}{size\_t} nao, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} maxmm) :}
\DoxyCodeLine{27         m\_nao(nao), m\_maxmm(maxmm), m\_op(maxmm * 3 + 1, 0) \{ \}}
\DoxyCodeLine{28 }
\DoxyCodeLine{29     \textcolor{keyword}{virtual} \mbox{\hyperlink{classlibwfa_1_1molcas__mom__builder}{\string~molcas\_mom\_builder}}() \{\}}
\DoxyCodeLine{30 }
\DoxyCodeLine{36     arma::mat \&\mbox{\hyperlink{classlibwfa_1_1molcas__mom__builder_adb938ccd2b8dce989452975158dfebc0}{set}}(\textcolor{keywordtype}{size\_t} c, \textcolor{keywordtype}{size\_t} n);}
\DoxyCodeLine{37     }
\DoxyCodeLine{43     \textcolor{keyword}{const} arma::mat \&\mbox{\hyperlink{classlibwfa_1_1molcas__mom__builder_a0665a4c517f2e0ff7b9007f8f91db5ab}{get}}(\textcolor{keywordtype}{size\_t} c, \textcolor{keywordtype}{size\_t} n) \textcolor{keyword}{const};}
\DoxyCodeLine{44 }
\DoxyCodeLine{47     \textcolor{keyword}{virtual} \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classlibwfa_1_1molcas__mom__builder_a73195da5cd380a03a57dd2d52837b705}{max\_moment}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_maxmm; \}}
\DoxyCodeLine{48 }
\DoxyCodeLine{51     \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{classlibwfa_1_1molcas__mom__builder_aa426347c2ee29f8e7fc4e5c50d6ea050}{perform}}(\textcolor{keyword}{const} arma::mat \&dm,}
\DoxyCodeLine{52         \textcolor{keywordtype}{size\_t} c1, \textcolor{keywordtype}{size\_t} n1, \textcolor{keywordtype}{size\_t} c2, \textcolor{keywordtype}{size\_t} n2) \textcolor{keyword}{const};}
\DoxyCodeLine{53 }
\DoxyCodeLine{56     \textcolor{keyword}{virtual} \textcolor{keywordtype}{double} \mbox{\hyperlink{classlibwfa_1_1molcas__mom__builder_a4b6bf205905db384c8642bec01cd61aa}{perform}}(\textcolor{keyword}{const} arma::mat \&dm, \textcolor{keywordtype}{size\_t} c, \textcolor{keywordtype}{size\_t} n) \textcolor{keyword}{const};}
\DoxyCodeLine{57 }
\DoxyCodeLine{58 \textcolor{keyword}{private}:}
\DoxyCodeLine{64     \textcolor{keyword}{static} \textcolor{keywordtype}{size\_t} get\_index(\textcolor{keywordtype}{size\_t} c, \textcolor{keywordtype}{size\_t} n) \{}
\DoxyCodeLine{65         \textcolor{keywordflow}{if} (n == 0) \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{66         \textcolor{keywordflow}{else} \textcolor{keywordflow}{return} n * 3 -\/ 2 + c;}
\DoxyCodeLine{67     \}}
\DoxyCodeLine{68 \};}
\DoxyCodeLine{69 }
\DoxyCodeLine{70 }
\DoxyCodeLine{71 \} \textcolor{comment}{// namespace libwfa}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// LIBWFA\_MOLCAS\_MOM\_BUILDER\_H}}

\end{DoxyCode}
