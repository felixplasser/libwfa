\hypertarget{exciton__moments_8h_source}{}\doxysection{exciton\+\_\+moments.\+h}
\label{exciton__moments_8h_source}\index{exciton\_moments.h@{exciton\_moments.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef LIBWFA\_EXCITON\_MOMENTS\_H}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define LIBWFA\_EXCITON\_MOMENTS\_H}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <cstddef>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <armadillo>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <libwfa/libwfa\_exception.h>}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{keyword}{namespace }libwfa \{}
\DoxyCodeLine{10 }
\DoxyCodeLine{17 \textcolor{keyword}{class }\mbox{\hyperlink{classlibwfa_1_1exciton__moments}{exciton\_moments}} \{}
\DoxyCodeLine{18 \textcolor{keyword}{private}:}
\DoxyCodeLine{19     \textcolor{keywordtype}{size\_t} m\_nmax; }
\DoxyCodeLine{20     arma::mat m\_mom; }
\DoxyCodeLine{21 }
\DoxyCodeLine{22 \textcolor{keyword}{public}:}
\DoxyCodeLine{25     \mbox{\hyperlink{classlibwfa_1_1exciton__moments_a0b4a60de9bbe11f5d796321656fd8ec9}{exciton\_moments}}(\textcolor{keywordtype}{size\_t} nmax = 1);}
\DoxyCodeLine{26 }
\DoxyCodeLine{29     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classlibwfa_1_1exciton__moments_a12060fd628e29ef3acd858785af6997e}{n\_max}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_nmax; \}}
\DoxyCodeLine{30 }
\DoxyCodeLine{36     \textcolor{keywordtype}{void} \mbox{\hyperlink{classlibwfa_1_1exciton__moments_aefd165cd4f92b70543a9ebf7f950e29f}{set}}(\textcolor{keywordtype}{size\_t} ne, \textcolor{keywordtype}{size\_t} nh, \textcolor{keyword}{const} arma::vec \&m) \{}
\DoxyCodeLine{37         m\_mom.col(determine\_loc(ne, nh)) = m;}
\DoxyCodeLine{38     \}}
\DoxyCodeLine{39 }
\DoxyCodeLine{48     arma::subview\_col<double> \mbox{\hyperlink{classlibwfa_1_1exciton__moments_a2ca6737545f161099b9eef1cf2ae1297}{get}}(\textcolor{keywordtype}{size\_t} ne, \textcolor{keywordtype}{size\_t} nh)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{49         \textcolor{keywordflow}{return} m\_mom.col(determine\_loc(ne, nh));}
\DoxyCodeLine{50     \}}
\DoxyCodeLine{51 }
\DoxyCodeLine{52 \textcolor{keyword}{private}:}
\DoxyCodeLine{53     \textcolor{keywordtype}{size\_t} determine\_loc(\textcolor{keywordtype}{size\_t} ne, \textcolor{keywordtype}{size\_t} nh) \textcolor{keyword}{const};}
\DoxyCodeLine{54 \};}
\DoxyCodeLine{55 }
\DoxyCodeLine{56 }
\DoxyCodeLine{57 \textcolor{keyword}{inline} \mbox{\hyperlink{classlibwfa_1_1exciton__moments_a0b4a60de9bbe11f5d796321656fd8ec9}{exciton\_moments::exciton\_moments}}(\textcolor{keywordtype}{size\_t} nmax) : m\_nmax(nmax),}
\DoxyCodeLine{58     m\_mom(3, ((nmax + 1) * (nmax + 2)) / 2, arma::fill::zeros) \{}
\DoxyCodeLine{59 }
\DoxyCodeLine{60 \}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62 }
\DoxyCodeLine{63 \textcolor{keyword}{inline} \textcolor{keywordtype}{size\_t} exciton\_moments::determine\_loc(\textcolor{keywordtype}{size\_t} ne, \textcolor{keywordtype}{size\_t} nh)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{64 }
\DoxyCodeLine{65     \textcolor{keywordtype}{size\_t} n = ne + nh;}
\DoxyCodeLine{66 \textcolor{preprocessor}{\#ifdef LIBWFA\_DEBUG}}
\DoxyCodeLine{67     \textcolor{keywordflow}{if} (n > m\_nmax) \{}
\DoxyCodeLine{68         \textcolor{keywordflow}{throw} \mbox{\hyperlink{classlibwfa_1_1libwfa__exception}{libwfa\_exception}}(\textcolor{stringliteral}{"{}exciton\_moments"{}},}
\DoxyCodeLine{69             \textcolor{stringliteral}{"{}determine\_loc(size\_t, size\_t)"{}}, \_\_FILE\_\_, \_\_LINE\_\_, \textcolor{stringliteral}{"{}N/A"{}});}
\DoxyCodeLine{70     \}}
\DoxyCodeLine{71 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73     \textcolor{keywordflow}{return} (n * (n + 1)) / 2 + ne;}
\DoxyCodeLine{74 \}}
\DoxyCodeLine{75 }
\DoxyCodeLine{76 }
\DoxyCodeLine{77 \} \textcolor{comment}{// namespace libwfa}}
\DoxyCodeLine{78 }
\DoxyCodeLine{79 }
\DoxyCodeLine{80 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
