\hypertarget{classlibwfa_1_1ctnum__analysis}{}\doxysection{libwfa\+::ctnum\+\_\+analysis Class Reference}
\label{classlibwfa_1_1ctnum__analysis}\index{libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}}


Charge transfer (CT) number analysis.  




{\ttfamily \#include $<$ctnum\+\_\+analysis.\+h$>$}

Inheritance diagram for libwfa\+::ctnum\+\_\+analysis\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classlibwfa_1_1ctnum__analysis}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classlibwfa_1_1ctnum__analysis_a0dc908c5d32c912d2f9fbfd862eed81a}{ctnum\+\_\+analysis}} (const arma\+::mat \&s, const arma\+::uvec \&b2p, const std\+::string \&method, const std\+::vector$<$ std\+::string $>$ \&prop\+\_\+list, const std\+::vector$<$ std\+::vector$<$ int $>$ $>$ \&at\+\_\+lists)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\mbox{\hyperlink{classlibwfa_1_1ctnum__analysis_a7195c83e52034cd543b27155317b36fb}{ctnum\+\_\+analysis}} (const arma\+::mat \&s, const arma\+::uvec \&b2p, const std\+::string \&method)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{classlibwfa_1_1ctnum__analysis_a5aa75a10fdeec8e330c2fefe7e1a82c5}\label{classlibwfa_1_1ctnum__analysis_a5aa75a10fdeec8e330c2fefe7e1a82c5}} 
virtual {\bfseries $\sim$ctnum\+\_\+analysis} ()
\begin{DoxyCompactList}\small\item\em Virtual destructor. \end{DoxyCompactList}\item 
virtual size\+\_\+t \mbox{\hyperlink{classlibwfa_1_1ctnum__analysis_a5951b6d7e4b46e77d18e96c637bde4d8}{size}} () const
\begin{DoxyCompactList}\small\item\em Return the dimension of the CT number matrix (e.\+g. \# atoms) \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{classlibwfa_1_1ctnum__analysis_ab27fbfdae0c363e6cf3dce5d90bd563f}{perform}} (const arma\+::mat \&tdm, arma\+::mat \&om, double \&Phe) const
\begin{DoxyCompactList}\small\item\em Perform CT number analysis for given transition density matrix. \end{DoxyCompactList}\item 
virtual arma\+::mat \mbox{\hyperlink{classlibwfa_1_1ctnum__analysis_a4b0214c3bbb08654facfab1c5439015c}{compute\+\_\+om\+Frag}} (const arma\+::mat \&om\+\_\+at) const
\begin{DoxyCompactList}\small\item\em Summation of the Omega matrix over fragments. \end{DoxyCompactList}\item 
virtual size\+\_\+t \mbox{\hyperlink{classlibwfa_1_1ctnum__analysis_a144b1d89730a4cb2d99c59670f33bb52}{n\+\_\+frags}} () const
\begin{DoxyCompactList}\small\item\em Number of fragments. \end{DoxyCompactList}\item 
virtual std\+::unordered\+\_\+map$<$ std\+::string, double $>$ \mbox{\hyperlink{classlibwfa_1_1ctnum__analysis_a38c9d9aa90dda6486ad19106093d0123}{compute\+\_\+descriptors}} (const double om\+\_\+tot, const arma\+::mat \&om\+\_\+frag) const
\begin{DoxyCompactList}\small\item\em Compute the Theo\+DORE-\/style descriptors. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{classlibwfa_1_1ctnum__analysis_ae21347afa30b8fdde6339dd47beba8b7}{form\+\_\+om}} (const arma\+::mat \&s, const arma\+::mat \&s\+\_\+sqrt, const arma\+::mat \&tdm, const std\+::string \&method, arma\+::mat \&om)
\begin{DoxyCompactList}\small\item\em Forms omega matrix from a transition density matrix. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Charge transfer (CT) number analysis. 

Basic implementation of CT number analysis. Provided a mapping of basis functions to molecular fragments (e.\+g. atoms) the class computes for every $ \Omega $ matrix in AOs the CT number matrix in terms of the fragments. 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlibwfa_1_1ctnum__analysis_a0dc908c5d32c912d2f9fbfd862eed81a}\label{classlibwfa_1_1ctnum__analysis_a0dc908c5d32c912d2f9fbfd862eed81a}} 
\index{libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}!ctnum\_analysis@{ctnum\_analysis}}
\index{ctnum\_analysis@{ctnum\_analysis}!libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}}
\doxysubsubsection{\texorpdfstring{ctnum\_analysis()}{ctnum\_analysis()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily libwfa\+::ctnum\+\_\+analysis\+::ctnum\+\_\+analysis (\begin{DoxyParamCaption}\item[{const arma\+::mat \&}]{s,  }\item[{const arma\+::uvec \&}]{b2p,  }\item[{const std\+::string \&}]{method,  }\item[{const std\+::vector$<$ std\+::string $>$ \&}]{prop\+\_\+list,  }\item[{const std\+::vector$<$ std\+::vector$<$ int $>$ $>$ \&}]{at\+\_\+lists }\end{DoxyParamCaption})}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em s} & Overlap matrix \\
\hline
{\em b2p} & Map of basis functions to molecular parts or fragments \\
\hline
{\em method} & Formula used to calculate CT number \\
\hline
{\em prop\+\_\+list} & Properties to be computed \\
\hline
{\em at\+\_\+lists} & Fragment definitions \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{classlibwfa_1_1ctnum__analysis_a7195c83e52034cd543b27155317b36fb}\label{classlibwfa_1_1ctnum__analysis_a7195c83e52034cd543b27155317b36fb}} 
\index{libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}!ctnum\_analysis@{ctnum\_analysis}}
\index{ctnum\_analysis@{ctnum\_analysis}!libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}}
\doxysubsubsection{\texorpdfstring{ctnum\_analysis()}{ctnum\_analysis()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily libwfa\+::ctnum\+\_\+analysis\+::ctnum\+\_\+analysis (\begin{DoxyParamCaption}\item[{const arma\+::mat \&}]{s,  }\item[{const arma\+::uvec \&}]{b2p,  }\item[{const std\+::string \&}]{method }\end{DoxyParamCaption})}



Constructor. 


\begin{DoxyParams}{Parameters}
{\em s} & Overlap matrix \\
\hline
{\em b2p} & Map of basis functions to molecular parts or fragments \\
\hline
{\em method} & Formula used to calculate CT number \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classlibwfa_1_1ctnum__analysis_a38c9d9aa90dda6486ad19106093d0123}\label{classlibwfa_1_1ctnum__analysis_a38c9d9aa90dda6486ad19106093d0123}} 
\index{libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}!compute\_descriptors@{compute\_descriptors}}
\index{compute\_descriptors@{compute\_descriptors}!libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}}
\doxysubsubsection{\texorpdfstring{compute\_descriptors()}{compute\_descriptors()}}
{\footnotesize\ttfamily virtual std\+::unordered\+\_\+map$<$ std\+::string, double $>$ libwfa\+::ctnum\+\_\+analysis\+::compute\+\_\+descriptors (\begin{DoxyParamCaption}\item[{const double}]{om\+\_\+tot,  }\item[{const arma\+::mat \&}]{om\+\_\+frag }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Compute the Theo\+DORE-\/style descriptors. 



Implements \mbox{\hyperlink{classlibwfa_1_1ctnum__analysis__i_a1a36b55085b8d1f113ece5dc1def1fc5}{libwfa\+::ctnum\+\_\+analysis\+\_\+i}}.

\mbox{\Hypertarget{classlibwfa_1_1ctnum__analysis_a4b0214c3bbb08654facfab1c5439015c}\label{classlibwfa_1_1ctnum__analysis_a4b0214c3bbb08654facfab1c5439015c}} 
\index{libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}!compute\_omFrag@{compute\_omFrag}}
\index{compute\_omFrag@{compute\_omFrag}!libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}}
\doxysubsubsection{\texorpdfstring{compute\_omFrag()}{compute\_omFrag()}}
{\footnotesize\ttfamily virtual arma\+::mat libwfa\+::ctnum\+\_\+analysis\+::compute\+\_\+om\+Frag (\begin{DoxyParamCaption}\item[{const arma\+::mat \&}]{om\+\_\+at }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Summation of the Omega matrix over fragments. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em om\+\_\+at} & Omega matrix over atoms \\
\hline
\end{DoxyParams}


Implements \mbox{\hyperlink{classlibwfa_1_1ctnum__analysis__i_a0863b1d369328b1dd25764dc3d493b2d}{libwfa\+::ctnum\+\_\+analysis\+\_\+i}}.

\mbox{\Hypertarget{classlibwfa_1_1ctnum__analysis_ae21347afa30b8fdde6339dd47beba8b7}\label{classlibwfa_1_1ctnum__analysis_ae21347afa30b8fdde6339dd47beba8b7}} 
\index{libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}!form\_om@{form\_om}}
\index{form\_om@{form\_om}!libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}}
\doxysubsubsection{\texorpdfstring{form\_om()}{form\_om()}}
{\footnotesize\ttfamily static void libwfa\+::ctnum\+\_\+analysis\+::form\+\_\+om (\begin{DoxyParamCaption}\item[{const arma\+::mat \&}]{s,  }\item[{const arma\+::mat \&}]{s\+\_\+sqrt,  }\item[{const arma\+::mat \&}]{tdm,  }\item[{const std\+::string \&}]{method,  }\item[{arma\+::mat \&}]{om }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Forms omega matrix from a transition density matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em s} & Overlap matrix \\
\hline
\mbox{\texttt{ in}}  & {\em s\+\_\+sqrt} & Square root of overlap matrix \\
\hline
\mbox{\texttt{ in}}  & {\em tdm} & Transition density matrix \\
\hline
\mbox{\texttt{ in}}  & {\em method} & Formula used to calculate CT number \\
\hline
\mbox{\texttt{ out}}  & {\em om} & Omega matrix\\
\hline
\end{DoxyParams}
The function implements the transforms of the transition density matrix into the $\Omega$ matrix, which is further used to compute the charge transfer numbers.

The implementation uses the new formula \[ \Omega_{\mu\nu} = 0.5 \left[ (\mathbf{D}\mathbf{S})_{\mu\nu} \times (\mathbf{S}\mathbf{D})_{\mu\nu} + D_{\mu\nu} \times (\mathbf{S}\mathbf{D}\mathbf{S})_{\mu\nu} \right] \] from \mbox{[}JCP(2014), DOI\+: 10.\+1063/1.4885819\mbox{]} rather than the original formula from \mbox{[}JCTC(2012), 8, 2777\mbox{]}.

In addition a Lowdin orthogonalization is implemented.

The output matrices are reshaped and resized as required. \mbox{\Hypertarget{classlibwfa_1_1ctnum__analysis_a144b1d89730a4cb2d99c59670f33bb52}\label{classlibwfa_1_1ctnum__analysis_a144b1d89730a4cb2d99c59670f33bb52}} 
\index{libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}!n\_frags@{n\_frags}}
\index{n\_frags@{n\_frags}!libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}}
\doxysubsubsection{\texorpdfstring{n\_frags()}{n\_frags()}}
{\footnotesize\ttfamily virtual size\+\_\+t libwfa\+::ctnum\+\_\+analysis\+::n\+\_\+frags (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Number of fragments. 



Implements \mbox{\hyperlink{classlibwfa_1_1ctnum__analysis__i_a0d1027cedd52de814d4368c601f75ed7}{libwfa\+::ctnum\+\_\+analysis\+\_\+i}}.

\mbox{\Hypertarget{classlibwfa_1_1ctnum__analysis_ab27fbfdae0c363e6cf3dce5d90bd563f}\label{classlibwfa_1_1ctnum__analysis_ab27fbfdae0c363e6cf3dce5d90bd563f}} 
\index{libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}!perform@{perform}}
\index{perform@{perform}!libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}}
\doxysubsubsection{\texorpdfstring{perform()}{perform()}}
{\footnotesize\ttfamily virtual void libwfa\+::ctnum\+\_\+analysis\+::perform (\begin{DoxyParamCaption}\item[{const arma\+::mat \&}]{tdm,  }\item[{arma\+::mat \&}]{om,  }\item[{double \&}]{Phe }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [virtual]}}



Perform CT number analysis for given transition density matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em tdm} & Transition density matrix in AO basis \\
\hline
\mbox{\texttt{ out}}  & {\em om} & Result CT number matrix \\
\hline
\mbox{\texttt{ out}}  & {\em Phe} & Expectation value of elec-\/hole permutation operator\\
\hline
\end{DoxyParams}
Perform the CT number analysis for the supplied transition density matrix in AO basis. Any implementation should adjust the output matrix to the correct size. 

Implements \mbox{\hyperlink{classlibwfa_1_1ctnum__analysis__i_a6b66ef8acd3e17b6d97ee296182af82b}{libwfa\+::ctnum\+\_\+analysis\+\_\+i}}.

\mbox{\Hypertarget{classlibwfa_1_1ctnum__analysis_a5951b6d7e4b46e77d18e96c637bde4d8}\label{classlibwfa_1_1ctnum__analysis_a5951b6d7e4b46e77d18e96c637bde4d8}} 
\index{libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}!size@{size}}
\index{size@{size}!libwfa::ctnum\_analysis@{libwfa::ctnum\_analysis}}
\doxysubsubsection{\texorpdfstring{size()}{size()}}
{\footnotesize\ttfamily virtual size\+\_\+t libwfa\+::ctnum\+\_\+analysis\+::size (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}



Return the dimension of the CT number matrix (e.\+g. \# atoms) 



Implements \mbox{\hyperlink{classlibwfa_1_1ctnum__analysis__i_abc0681eabe9833ed88e8043cce731675}{libwfa\+::ctnum\+\_\+analysis\+\_\+i}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
ctnum\+\_\+analysis.\+h\end{DoxyCompactItemize}
